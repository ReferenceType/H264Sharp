<Project Sdk="Microsoft.NET.Sdk">
  
  <!--<Target Name="AfterBuild">
    <ItemGroup>
      <_ContentFiles Include="$(MSBuildThisFileDirectory)..\contentFiles\any\any\**\*.so" />
    </ItemGroup>

    <Copy SourceFiles="@(_ContentFiles)" DestinationFolder="$(OutDir)\%(RecursiveDir)" SkipUnchangedFiles="true" OverwriteReadOnlyFiles="true" />
  </Target>-->
  <Target Name="AfterBuild">
  <ItemGroup>
    <None Include="$(MSBuildThisFileDirectory)\runtimes\linux64\native\H264SharpNative-linux64.so">
      <Link>H264SharpNative-linux64.so</Link>
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  </Target>
  <PropertyGroup>
    <TargetFrameworks>netstandard2.0;net8.0</TargetFrameworks>
    <AllowUnsafeBlocks>True</AllowUnsafeBlocks>
    <GeneratePackageOnBuild>True</GeneratePackageOnBuild>
    <Title>H264Sharp-linux</Title>
    <Version>1.3.0</Version>
    <PackageProjectUrl>https://github.com/ReferenceType/H264Sharp</PackageProjectUrl>
    <Authors>ReferenceType</Authors>
    <RepositoryUrl>https://github.com/ReferenceType/H264Sharp</RepositoryUrl>
    <PackageTags>h264;openh264;transcoder;h264sharp</PackageTags>
    <PackageReleaseNotes>https://github.com/ReferenceType/H264Sharp/releases/</PackageReleaseNotes>
    <PackageId>H264Sharp-linux</PackageId>
    <Description>Cisco's OpenH264 wrapper for .Net with SIMD color model conversion support</Description>

    <Copyright></Copyright>
  </PropertyGroup>

<PropertyGroup>
  <GenerateDocumentationFile>true</GenerateDocumentationFile>
  <PackageLicenseFile>Licence.txt</PackageLicenseFile>
  <IncludeContentInPack>true</IncludeContentInPack>

</PropertyGroup>



  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('Windows'))">
    <DefineConstants>OS_WINDOWS</DefineConstants>
  </PropertyGroup>
  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('Linux'))">
    <DefineConstants>OS_LINUX</DefineConstants>
  </PropertyGroup>
  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('FreeBSD'))">
    <DefineConstants>OS_FREEBSD</DefineConstants>
  </PropertyGroup>
  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('OSX'))">
    <DefineConstants>OS_MAC</DefineConstants>
  </PropertyGroup>
  
    
  <ItemGroup>
    
    <Content Include="runtimes\win-x64\native\*" CopyToOutputDirectory="Always" PackageCopyToOutput="true" Pack="true" PackagePath="\lib\netstandard2.0" />
    <Content Include="runtimes\win-x64\native\*" CopyToOutputDirectory="Always" PackageCopyToOutput="true" Pack="true" PackagePath="\lib\net8.0" />
    <Content Include="runtimes\linux64\native\*" CopyToOutputDirectory="Always" PackageCopyToOutput="true" Pack="true" PackagePath="/contentFiles/any/any/" />
    <None Include="runtimes\linux64\native\H264SharpNative-linux64.so">
      <Pack>true</Pack>
      <PackageCopyToOutput>true</PackageCopyToOutput>
      <PackageFlatten>true</PackageFlatten>
      <PackagePath>contentFiles\any\asset;content\any\asset</PackagePath>
    </None>
    <None Include="runtimes\linux64\native\libopenh264-2.4.1-linux64.7.so">
      <Pack>true</Pack>
      <PackageCopyToOutput>true</PackageCopyToOutput>
      <PackageFlatten>true</PackageFlatten>
      <PackagePath>contentFiles\any\asset;content\any\asset</PackagePath>
    </None>
    <Content Include="runtimes\win-x86\native\*" CopyToOutputDirectory="Always" PackageCopyToOutput="true" Pack="true" PackagePath="\lib\netstandard2.0" />
    <Content Include="runtimes\win-x86\native\*" CopyToOutputDirectory="Always" PackageCopyToOutput="true" Pack="true" PackagePath="\lib\net8.0" />
    <Content Include="runtimes\linux86\native\*" CopyToOutputDirectory="Always" PackageCopyToOutput="true" Pack="true" PackagePath="/contentFiles/any/any/" />
    <!--<Content Include="runtimes\linux86\native\*"  CopyToOutputDirectory="Always"  PackageCopyToOutput="true" Pack="true" PackagePath="\lib\net8.0" />-->
  </ItemGroup>
  
    
  <ItemGroup>
    <Content Remove="runtimes\linux64\native\H264SharpNative-linux64.so" />
    <Content Remove="runtimes\linux64\native\libopenh264-2.4.1-linux64.7.so" />
  </ItemGroup>

  <ItemGroup>
    <None Include="..\Resources\Licence.txt">
      <Pack>True</Pack>
      <PackagePath>\</PackagePath>
    </None>
  </ItemGroup>

  <ItemGroup>
    <None Update="Licence.txt">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <Pack>True</Pack>
      <PackagePath>\</PackagePath>
    </None>
  </ItemGroup>
    
  
</Project>
 